{
  "name": "VidyaMitra Resume Analysis Flow",
  "nodes": [
    {
      "id": "webhook_trigger",
      "name": "Resume Upload Trigger",
      "type": "n8n-nodes-base.webhook",
      "parameters": {
        "path": "resume-upload",
        "httpMethod": "POST"
      }
    },
    {
      "id": "gdrive_upload",
      "name": "Upload to Google Drive",
      "type": "n8n-nodes-base.googleDrive",
      "parameters": {
        "operation": "upload",
        "name": "={{ $json.fileName }}",
        "folderId": "YOUR_GDRIVE_FOLDER_ID"
      }
    },
    {
      "id": "analyze_resume",
      "name": "Analyze Resume",
      "type": "n8n-nodes-base.httpRequest",
      "parameters": {
        "url": "http://your-api:8000/api/webhook/resume/analyze",
        "method": "POST",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify({ user_id: $json.user_id, data: { resume_text: $json.text, target_role: $json.target_role, file_id: $json.fileId } }) }}"
      }
    },
    {
      "id": "check_score",
      "name": "Check Score < 60?",
      "type": "n8n-nodes-base.if",
      "parameters": {
        "conditions": {
          "number": [{"value1": "={{ $json.analysis.score }}", "operation": "smaller", "value2": 60}]
        }
      }
    },
    {
      "id": "enhance_resume",
      "name": "Auto-Enhance Resume",
      "type": "n8n-nodes-base.httpRequest",
      "parameters": {
        "url": "http://your-api:8000/api/webhook/resume/enhance",
        "method": "POST",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify({ user_id: $json.user_id, data: { resume_text: $json.resume_text, target_role: $json.target_role } }) }}"
      }
    }
  ],
  "connections": {
    "webhook_trigger": {"main": [[{"node": "gdrive_upload"}]]},
    "gdrive_upload": {"main": [[{"node": "analyze_resume"}]]},
    "analyze_resume": {"main": [[{"node": "check_score"}]]},
    "check_score": {"main": [[{"node": "enhance_resume"}], [{"node": "respond"}]]}
  }
}
